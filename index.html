<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Family Flipbook</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #ccc;
    user-select: none;
  }

  .flipbook {
    position: relative;
    width: 589px;       /* closed width */
    height: 885px;
    perspective: 2000px;
    transition: width 0.6s ease;
  }

  .flipbook.expanded {
    width: 1178px;      /* open spread */
  }

  .spine {
    position: absolute;
    left: 50%;
    top: 0;
    width: 6px;
    height: 100%;
    background: #222;
    transform: translateX(-50%);
    z-index: 5;
  }

  .page {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    transform-style: preserve-3d;
    transform-origin: center;
    transition: transform 1s cubic-bezier(.65,0,.35,1), box-shadow 1s;
    backface-visibility: hidden;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: inset -10px 0 40px rgba(0,0,0,0.25);
    background: white;
  }

  .page img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .page.flipping {
    box-shadow: inset -30px 0 80px rgba(0,0,0,0.35);
  }

  .page.flipped {
    transform: rotateY(-180deg);
    z-index: 0;
  }

  .black-side {
    width: 50%;
    height: 100%;
    background: black;
    position: absolute;
    top: 0;
  }

  .black-left { left: 0; }
  .black-right { right: 0; }
</style>
</head>
<body>

<div class="flipbook" id="flipbook">
  <div class="spine"></div>
</div>

<script>
const flipbook = document.getElementById('flipbook');
const base = "https://cesarsanchezgraphics-prog.github.io/IFyouknewmyfamily/";
const totalSpreads = 41;
const pages = [];
let currentPage = 0;

// FRONT COVER
const cover = document.createElement('div');
cover.className = 'page cover';
cover.style.zIndex = totalSpreads + 3;
cover.style.transformOrigin = 'left center';
cover.innerHTML = `<img src="${base}OnlineCover.jpg" alt="Front Cover">`;
flipbook.appendChild(cover);
pages.push(cover);

// PAGE 1 (black left + page)
const page1 = document.createElement('div');
page1.className = 'page spread';
page1.style.zIndex = totalSpreads + 2;
page1.innerHTML = `
  <div class="black-side black-left"></div>
  <img src="${base}Composition1.jpg" style="width:50%;position:absolute;right:0;">
`;
flipbook.appendChild(page1);
pages.push(page1);

// INNER SPREADS (Composition2â€“Composition40)
for(let i=2;i<totalSpreads;i++){
  const spread = document.createElement('div');
  spread.className = 'page spread';
  spread.style.zIndex = totalSpreads - i + 1;
  spread.innerHTML = `<img src="${base}Composition${i}.jpg" alt="Spread ${i}">`;
  flipbook.appendChild(spread);
  pages.push(spread);
}

// PAGE 41 (page + black right)
const page41 = document.createElement('div');
page41.className = 'page spread';
page41.style.zIndex = 2;
page41.innerHTML = `
  <img src="${base}Composition41.jpg" style="width:50%;position:absolute;left:0;">
  <div class="black-side black-right"></div>
`;
flipbook.appendChild(page41);
pages.push(page41);

// BACK COVER (OnlineCover2)
const backCover = document.createElement('div');
backCover.className = 'page cover';
backCover.style.zIndex = 1;
backCover.style.transformOrigin = 'right center';
backCover.innerHTML = `<img src="${base}OnlineCover2.jpg" alt="Back Cover">`;
flipbook.appendChild(backCover);
pages.push(backCover);

// FLIP LOGIC
flipbook.addEventListener('click', e => {
  const rect = flipbook.getBoundingClientRect();
  const x = e.clientX - rect.left;
  let page;

  // Right side click = flip forward
  if (x > rect.width/2 && currentPage < pages.length) {
    page = pages[currentPage];

    if (currentPage === 0) {
      flipbook.classList.add('expanded'); // expand on first flip
    }
    page.style.transformOrigin = (currentPage === 0) ? 'left center' : 'center center';
    page.classList.add('flipping');
    setTimeout(()=>{
      page.classList.remove('flipping');
      page.classList.add('flipped');
      currentPage++;
    },200);

    // Shrink back when last page flips
    if (currentPage === pages.length - 1) {
      setTimeout(()=>flipbook.classList.remove('expanded'), 800);
    }

  // Left side click = flip back
  } else if (x < rect.width/2 && currentPage > 0) {
    currentPage--;
    page = pages[currentPage];
    page.style.transformOrigin = (currentPage === 0) ? 'left center' : 'center center';
    page.classList.add('flipping');
    setTimeout(()=>{
      page.classList.remove('flipping');
      page.classList.remove('flipped');
    },200);
  }
});
</script>
</body>
</html>
