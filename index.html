<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Composition Flipbook</title>
<style>
:root {
  --page-w: 589px;    /* 6.14in @ 96dpi */
  --page-h: 885px;    /* 9.21in @ 96dpi */
  --spread-w: calc(var(--page-w) * 2); /* 1178px */
}

/* basic layout */
html, body {
  margin: 0;
  height: 100%;
  background: #ccc;
  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
}

/* responsive wrapper */
.book-wrap {
  width: var(--page-w);
  height: var(--page-h);
  transform-origin: top left;
  position: relative;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  transition: transform 0.4s ease;
}

/* flipbook container */
.flipbook {
  width: var(--page-w);
  height: var(--page-h);
  position: relative;
  perspective: 2000px;
  transition: width 0.4s cubic-bezier(.45,.05,.55,.95), box-shadow 0.4s;
  will-change: width, transform;
  background: #fff;
  border-radius: 4px;
  overflow: hidden;
}

/* expanded state (inner spreads) */
.flipbook.expanded {
  width: var(--spread-w);
  box-shadow: 0 40px 80px rgba(0,0,0,0.4);
}

/* page styles */
.page {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transform-origin: center center;
  backface-visibility: hidden;
  transition: transform 0.7s cubic-bezier(.55,.05,.35,.95), box-shadow 0.7s;
  will-change: transform, box-shadow;
  overflow: hidden;
  background: #fff;
}

.page img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* flip animation */
.page.flipping {
  transform: rotateY(-20deg);
  box-shadow: inset -40px 0 80px rgba(0,0,0,0.3);
}
.page.flipped {
  transform: rotateY(-180deg);
  box-shadow: inset 20px 0 60px rgba(0,0,0,0.2);
}

/* black filler pages */
.black-half {
  width: var(--page-w);
  height: var(--page-h);
  background: #000;
}

/* responsive scaling */
@media (max-width: 1200px) {
  .book-wrap {
    transform: scale(0.8);
  }
}
@media (max-width: 900px) {
  .book-wrap {
    transform: scale(0.6);
  }
}
</style>
</head>
<body>

<div class="book-wrap">
  <div class="flipbook" id="flipbook"></div>
</div>

<script>
const flipbook = document.getElementById("flipbook");
const BASE = "https://cesarsanchezgraphics-prog.github.io/IFyouknewmyfamily/";
const totalSpreads = 41; // Composition.jpg to Composition41.jpg
const pages = [];
let currentPage = 0;

// --- FRONT COVER ---
const front = document.createElement("div");
front.className = "page cover";
front.style.zIndex = totalSpreads + 3;
const coverImg = document.createElement("img");
coverImg.src = BASE + "OnlineCover.jpg";
front.appendChild(coverImg);
flipbook.appendChild(front);
pages.push(front);

// --- PAGE 1: left half black, right = Composition.jpg ---
const p1 = document.createElement("div");
p1.className = "page";
p1.style.zIndex = totalSpreads + 2;
p1.style.display = "flex";

const blackLeft = document.createElement("div");
blackLeft.className = "black-half";
p1.appendChild(blackLeft);

const img1 = document.createElement("img");
img1.src = BASE + "Composition.jpg";
img1.style.width = "var(--page-w)";
img1.style.height = "var(--page-h)";
p1.appendChild(img1);

flipbook.appendChild(p1);
pages.push(p1);

// --- INNER SPREADS: Composition2 .. Composition40 ---
for (let i = 2; i <= 40; i++) {
  const spread = document.createElement("div");
  spread.className = "page spread";
  spread.style.zIndex = totalSpreads - i + 1;

  const img = document.createElement("img");
  img.src = BASE + `Composition${i}.jpg`;
  spread.appendChild(img);

  flipbook.appendChild(spread);
  pages.push(spread);
}

// --- PAGE 41: right half black ---
const p41 = document.createElement("div");
p41.className = "page";
p41.style.zIndex = 1;
p41.style.display = "flex";

const img41 = document.createElement("img");
img41.src = BASE + "Composition41.jpg";
img41.style.width = "var(--page-w)";
img41.style.height = "var(--page-h)";
p41.appendChild(img41);

const blackRight = document.createElement("div");
blackRight.className = "black-half";
p41.appendChild(blackRight);

flipbook.appendChild(p41);
pages.push(p41);

// --- BACK COVER ---
const back = document.createElement("div");
back.className = "page cover";
back.style.zIndex = 0;
const backImg = document.createElement("img");
backImg.src = BASE + "OnlineCover2.jpg";
back.appendChild(backImg);
flipbook.appendChild(back);
pages.push(back);

// --- FLIP LOGIC ---
flipbook.addEventListener("click", e => {
  const rect = flipbook.getBoundingClientRect();
  const x = e.clientX - rect.left;
  let page;

  if (x > rect.width / 2 && currentPage < pages.length - 1) {
    page = pages[currentPage];
    page.classList.add("flipping");

    // expand book slightly after flip begins
    if (currentPage === 0) setTimeout(() => flipbook.classList.add("expanded"), 150);

    setTimeout(() => {
      page.classList.remove("flipping");
      page.classList.add("flipped");
      currentPage++;
    }, 150);

  } else if (x < rect.width / 2 && currentPage > 0) {
    currentPage--;
    page = pages[currentPage];
    page.classList.add("flipping");

    // shrink when returning to cover
    if (currentPage === 0) setTimeout(() => flipbook.classList.remove("expanded"), 150);

    setTimeout(() => {
      page.classList.remove("flipping");
      page.classList.remove("flipped");
    }, 150);
  }
});
</script>

</body>
</html>
